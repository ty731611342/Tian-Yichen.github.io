---
layout: post
title: "For循环嵌套的代码优化思路"
date: 2020-11-03
excerpt: "For循环嵌套优化"
tags: [for, 代码优化, 嵌套]
comments: true
---

看如下for循环嵌套，思考如何进行优化变量看如下for循环嵌套，思考如何进行优化。
```
for (int i = 0; i < 1000; i++)
{
    for (int j = 0; j < 100; j++)
    {
        for (int k = 0; k < 10; k++)
        {
            System.out.println(i+""+j+""+k);
         }
    }
}
```
查看代码可以得到，不论如何优化函数执行的次数不可能发生变化，不存在优化的可能，考虑从其他方面入手。那么代码的优化就只能从循环变量i，j，k的实例化，初始化，比较，自增等方面的耗时进行分析。
原代码循环变量在实例化，初始化，比较，自增方面的耗时如下：

| 变量 |实例化（次数）  |初始化（次数）  |比较（次数）  |自增（次数）  |
| --- | --- | --- | --- | --- |
| i | 1 | 1 | 1000 | 1000 |
| j | 1000 | 1000 | 1000* 100 | 1000 * 100 |
| k | 1000 * 100 | 1000 * 100 | 1000 * 100 * 10 | 1000 * 100 * 10 |

该代码的性能优化就是尽可能减少循环变量i、j、k的实例化、初始化、比较、自增的次数，同时，不能引进其它可能的运算耗时。 


## 优化方案一 
```
for(int i = 0; i < 10; i++)
{
    for(int j = 0; j < 100; j++)
    {
        for(int k = 0; k < 1000; k++)
        {
            System.out.println(i+""+j+""+k); 
        }
    }
}
```

该方案主要是将循环次数最少的放到外面，循环次数最多的放里面，这样可以最大程度的（注：3个不同次数的循环变量共有6种排列组合情况，此种组合为最优）减少相关循环变量的实例化次数、初始化次数、比较次数、自增次数，方案耗时情况如下： 

| 变量 | 实例化（次数） |初始化（次数）  | 比较（次数） | 自增（次数） |
| --- | --- | --- | --- | --- |
| i | 1 | 1 | 10 | 10 |
| j |10  | 10 | 10 * 100 | 10 * 100 |
| k | 10 * 100 | 10 * 100 | 10 * 100 * 1000 | 10 * 100 * 1000 |

## 优化方案二
```
int i, j, k;  
for (i = 0; i < 10; i++)  
{
    for (j = 0; j < 100; j++)
    {
        for (k = 0; k < 1000; k++)
        {
            System.out.println(i+""+j+""+k); 
        }
    }
}
```

该方案在方案一的基础上，将循环变量的实例化放到循环外，这样可以进一步减少相关循环变量的实例化次数，方案耗时情况如下： 

| 变量 | 实例化（次数） | 初始化（次数） | 比较（次数） | 自增（次数） |
| --- | --- | --- | --- | --- |
| i | 1 |1  | 10 | 10 |
| j | 1 |10  | 10 * 100 |10 * 100  |
| k | 1 | 10 * 100 | 10 * 100 * 1000 |10 * 100 * 1000  |